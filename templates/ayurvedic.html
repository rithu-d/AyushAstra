{% extends "base.html" %}

{% block title %}Ayurvedic Remedies - AyushAstra{% endblock %}

{% block content %}
<div class="min-h-screen bg-gradient-to-br from-ayurvedic-cream to-white py-12">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="text-center mb-12">
            <h2 class="text-4xl font-bold text-gray-800 mb-4">Ayurvedic Remedies</h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                Explore ancient Ayurvedic herbs and natural remedies for holistic healing. 
                Each remedy is backed by centuries of traditional wisdom and modern research.
            </p>
        </div>

        <!-- Filters -->
        <div class="mb-8">
            <div class="bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-gray-200">
                <!-- Search -->
                <div class="mb-6">
                    <div class="relative max-w-md mx-auto">
                        <input
                            type="text"
                            id="remedy-search"
                            placeholder="Search remedies or herbs..."
                            class="w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:border-ayurvedic-green focus:outline-none"
                        />
                        <i class="fas fa-search absolute right-3 top-3.5 text-gray-400"></i>
                    </div>
                </div>

                <!-- Category Filter -->
                <div class="mb-4">
                    <h3 class="text-sm font-medium text-gray-700 mb-3 flex items-center gap-2">
                        <i class="fas fa-filter"></i>
                        Category
                    </h3>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterByCategory('All')" class="category-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">All</button>
                        <button onclick="filterByCategory('Anti-inflammatory')" class="category-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Anti-inflammatory</button>
                        <button onclick="filterByCategory('Adaptogen')" class="category-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Adaptogen</button>
                        <button onclick="filterByCategory('Digestive')" class="category-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Digestive</button>
                        <button onclick="filterByCategory('Nervine')" class="category-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Nervine</button>
                    </div>
                </div>

                <!-- Condition Filter -->
                <div>
                    <h3 class="text-sm font-medium text-gray-700 mb-3">Health Condition</h3>
                    <div class="flex flex-wrap gap-2">
                        <button onclick="filterByCondition('All')" class="condition-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">All</button>
                        <button onclick="filterByCondition('Arthritis')" class="condition-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Arthritis</button>
                        <button onclick="filterByCondition('Anxiety')" class="condition-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Anxiety</button>
                        <button onclick="filterByCondition('Digestive Issues')" class="condition-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Digestive Issues</button>
                        <button onclick="filterByCondition('Insomnia')" class="condition-btn px-3 py-1 rounded-full text-sm border border-gray-300 hover:ayurvedic-green hover:text-white transition-colors">Insomnia</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Count -->
        <div class="mb-6">
            <p id="results-count" class="text-gray-600">
                Showing {{ ayurvedic_remedies|length }} remed{{ 'ies' if ayurvedic_remedies|length != 1 else 'y' }}
            </p>
        </div>

        <!-- Remedies Grid -->
        <div id="remedies-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for remedy in ayurvedic_remedies %}
            <div class="remedy-card bg-white rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1" data-category="{{ remedy.category }}" data-conditions="{{ remedy.conditions|join(',') }}">
                <div class="p-6">
                    <!-- Header -->
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-800 mb-1">{{ remedy.name }}</h3>
                            <p class="text-sm text-ayurvedic-sage italic">{{ remedy.herb_name }}</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <span class="px-2 py-1 rounded-full text-xs font-medium bg-ayurvedic-green text-white">
                                {{ remedy.category }}
                            </span>
                        </div>
                    </div>
                    
                    <!-- Image placeholder -->
                    <div class="w-full h-48 bg-gradient-to-br from-ayurvedic-earth to-ayurvedic-gold rounded-lg flex items-center justify-center mb-4">
                        <div class="text-white text-6xl opacity-50">ðŸŒ¿</div>
                    </div>
                    
                    <!-- Description -->
                    <div class="mb-4">
                        <p class="text-sm text-gray-600 line-clamp-3">
                            {{ remedy.description }}
                        </p>
                    </div>
                    
                    <!-- Benefits -->
                    <div class="mb-4">
                        <h4 class="font-medium text-gray-700 mb-2 flex items-center gap-2">
                            <i class="fas fa-leaf text-green-500"></i>
                            Benefits
                        </h4>
                        <ul class="text-sm text-gray-600 space-y-1">
                            {% for benefit in remedy.benefits[:3] %}
                            <li class="flex items-start gap-2">
                                <span class="text-ayurvedic-green mt-1">â€¢</span>
                                {{ benefit }}
                            </li>
                            {% endfor %}
                            {% if remedy.benefits|length > 3 %}
                            <li class="text-xs text-gray-500 italic">
                                +{{ remedy.benefits|length - 3 }} more benefits
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                    
                    <!-- Dosage -->
                    <div class="flex items-center gap-2 text-sm text-gray-600 mb-4">
                        <i class="fas fa-clock text-blue-500"></i>
                        <span>{{ remedy.dosage }}</span>
                    </div>
                    
                    <!-- Preparation preview -->
                    <div class="mb-4">
                        <h4 class="font-medium text-gray-700 mb-2">Preparation</h4>
                        <p class="text-sm text-gray-600 line-clamp-2">
                            {{ remedy.preparation[0] }}
                        </p>
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex gap-2">
                        <button onclick="showRemedyDetails('{{ remedy.id }}')" class="flex-1 ayurvedic-green text-white px-4 py-2 rounded-lg hover:bg-ayurvedic-sage transition-colors">
                            Learn More
                        </button>
                        <button onclick="addToFavorites('{{ remedy.id }}')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                            <i class="fas fa-book"></i>
                        </button>
                    </div>
                    
                    <!-- Precautions -->
                    {% if remedy.precautions %}
                    <div class="pt-2 border-t border-gray-100 mt-4">
                        <div class="flex items-center gap-2 text-xs text-amber-600">
                            <i class="fas fa-exclamation-triangle"></i>
                            <span>Check precautions before use</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- No Results -->
        <div id="no-results" class="text-center py-12 hidden">
            <div class="text-6xl mb-4">ðŸŒ¿</div>
            <h3 class="text-xl font-semibold text-gray-700 mb-2">No remedies found</h3>
            <p class="text-gray-500">
                Try adjusting your filters or search terms to find the perfect Ayurvedic remedy for you.
            </p>
        </div>

        <!-- Disclaimer -->
        <div class="mt-12 bg-amber-50 border border-amber-200 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-amber-800 mb-2">Important Disclaimer</h3>
            <p class="text-amber-700 text-sm leading-relaxed">
                The information provided is for educational purposes only and should not be considered as medical advice. 
                Always consult with a qualified healthcare professional before starting any new treatment or remedy, 
                especially if you have existing health conditions or are taking medications.
            </p>
        </div>
    </div>
</div>

<!-- Remedy Details Modal -->
<div id="remedy-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div class="p-6">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modal-title" class="text-2xl font-bold text-gray-800"></h3>
                <button onclick="closeRemedyModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="modal-content">
                <!-- Content will be populated by JavaScript -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    const ayurvedicRemedies = {{ ayurvedic_remedies|tojson }};
    let currentCategory = 'All';
    let currentCondition = 'All';

    function filterByCategory(category) {
        currentCategory = category;
        updateFilters();
        filterRemedies();
    }

    function filterByCondition(condition) {
        currentCondition = condition;
        updateFilters();
        filterRemedies();
    }

    function updateFilters() {
        // Update button styles
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.classList.remove('ayurvedic-green', 'text-white');
            btn.classList.add('border-gray-300');
        });
        document.querySelectorAll('.condition-btn').forEach(btn => {
            btn.classList.remove('ayurvedic-green', 'text-white');
            btn.classList.add('border-gray-300');
        });

        // Highlight active buttons
        event.target.classList.add('ayurvedic-green', 'text-white');
        event.target.classList.remove('border-gray-300');
    }

    function filterRemedies() {
        const searchTerm = document.getElementById('remedy-search').value.toLowerCase();
        const cards = document.querySelectorAll('.remedy-card');
        let visibleCount = 0;

        cards.forEach(card => {
            const category = card.dataset.category;
            const conditions = card.dataset.conditions.toLowerCase();
            const remedyName = card.querySelector('h3').textContent.toLowerCase();
            const herbName = card.querySelector('p').textContent.toLowerCase();

            const matchesCategory = currentCategory === 'All' || category === currentCategory;
            const matchesCondition = currentCondition === 'All' || conditions.includes(currentCondition.toLowerCase());
            const matchesSearch = searchTerm === '' || remedyName.includes(searchTerm) || herbName.includes(searchTerm);

            if (matchesCategory && matchesCondition && matchesSearch) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        // Update results count
        document.getElementById('results-count').textContent = 
            `Showing ${visibleCount} remed${visibleCount !== 1 ? 'ies' : 'y'}`;

        // Show/hide no results message
        const noResults = document.getElementById('no-results');
        if (visibleCount === 0) {
            noResults.classList.remove('hidden');
        } else {
            noResults.classList.add('hidden');
        }
    }

    function showRemedyDetails(remedyId) {
        const remedy = ayurvedicRemedies.find(r => r.id === remedyId);
        if (!remedy) return;

        document.getElementById('modal-title').textContent = remedy.name;
        
        const content = `
            <div class="space-y-4">
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Herb Name</h4>
                    <p class="text-ayurvedic-sage italic">${remedy.herb_name}</p>
                </div>
                
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Description</h4>
                    <p class="text-gray-600">${remedy.description}</p>
                </div>
                
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Benefits</h4>
                    <ul class="list-disc list-inside text-gray-600 space-y-1">
                        ${remedy.benefits.map(benefit => `<li>${benefit}</li>`).join('')}
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Preparation</h4>
                    <ol class="list-decimal list-inside text-gray-600 space-y-1">
                        ${remedy.preparation.map(step => `<li>${step}</li>`).join('')}
                    </ol>
                </div>
                
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Dosage</h4>
                    <p class="text-gray-600">${remedy.dosage}</p>
                </div>
                
                ${remedy.precautions.length > 0 ? `
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Precautions</h4>
                    <ul class="list-disc list-inside text-amber-600 space-y-1">
                        ${remedy.precautions.map(precaution => `<li>${precaution}</li>`).join('')}
                    </ul>
                </div>
                ` : ''}
            </div>
        `;
        
        document.getElementById('modal-content').innerHTML = content;
        document.getElementById('remedy-modal').classList.remove('hidden');
    }

    function closeRemedyModal() {
        document.getElementById('remedy-modal').classList.add('hidden');
    }

    function addToFavorites(remedyId) {
        alert('Added to favorites! (Feature coming soon)');
    }

    // Search functionality
    document.getElementById('remedy-search').addEventListener('input', filterRemedies);

    // Close modal when clicking outside
    document.getElementById('remedy-modal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeRemedyModal();
        }
    });
</script>
{% endblock %}
